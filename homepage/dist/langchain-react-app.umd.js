/*! For license information please see langchain-react-app.umd.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("React"),require("ReactDOM")):"function"==typeof define&&define.amd?define(["React","ReactDOM"],t):"object"==typeof exports?exports.LangChainReactApp=t(require("React"),require("ReactDOM")):e.LangChainReactApp=t(e.React,e.ReactDOM)}(this,((e,t)=>(()=>{"use strict";var n={626:(e,t,n)=>{n.d(t,{A:()=>s});var o=n(601),r=n.n(o),a=n(314),i=n.n(a)()(r());i.push([e.id,"@import url(https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap);"]),i.push([e.id,"body {\n  font-family: \"Poppins\", sans-serif;\n}\n\n.App {\n  text-align: center;\n  display: flex;\n}\n\n.App-logo {\n  height: 40vmin;\n  pointer-events: none;\n}\n\n@media (prefers-reduced-motion: no-preference) {\n  .App-logo {\n    animation: App-logo-spin infinite 20s linear;\n  }\n}\n\n.App-header {\n  background-color: #282c34;\n  min-height: 100vh;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  font-size: calc(10px + 2vmin);\n  color: white;\n}\n\n.App-link {\n  color: #61dafb;\n}\n\n@keyframes App-logo-spin {\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n\n\n/* CSS equivalent to Tailwind classes */\n.message-bubble {\n  display: flex;\n  border-radius: 0.25rem; /* equivalent to 'rounded' */\n  padding: 0.5rem 1rem; /* equivalent to 'px-4 py-2' */\n  max-width: 80%; /* equivalent to 'max-w-[80%]' */\n  margin-bottom: 2rem; /* equivalent to 'mb-8' */\n}\n\n.message-bubble-user {\n  background-color: #0284c7; /* equivalent to 'bg-sky-600' */\n  margin-left: auto; /* equivalent to 'ml-auto' */\n  color: #F7F8FA;\n}\n\n.message-bubble-ai {\n  background-color: #F7EFE5; /* equivalent to 'bg-slate-50' */\n  margin-right: auto; /* equivalent to 'mr-auto' */\n  color: #000;\n}\n\n.message-prefix {\n  margin-right: 0.5rem; /* equivalent to 'mr-2' */\n}\n\n.message-content {\n  white-space: pre-wrap; /* equivalent to 'whitespace-pre-wrap' */\n  display: flex;\n  flex-direction: column; /* equivalent to 'flex flex-col' */\n}\n\n\n/* CSS for ChatWindow Component */\n\n.chat-window {\n  flex: 1;\n  flex-direction: column;\n  overflow: hidden;\n  /* For backgroundColor and color based on theme, you'll need to handle it differently */\n  position: absolute;\n  bottom: 80px;\n  right: 20px;\n  border-radius: 10px;\n  width: 400px;\n}\n.chat-window.light-theme {\n  background-color: #fff;\n  color: #000;\n}\n\n.chat-window.dark-theme {\n  background-color: #000;\n  color: #fff;\n}\n\n\n.chat-button {\n  position: fixed;\n  bottom: 20px;\n  right: 20px;\n  background-color: #0284c7;\n  border-radius: 50%;\n  margin: 10px;\n  border: none;\n  cursor: pointer;\n  font-size: 48px;\n  color: white;\n}\n\n/* Additional styles for the form and input fields */\n.form-container {\n  display: flex;\n  flex-direction: column;\n  background-color: #0284c7;\n}\n\n.input-field {\n  flex: 1;\n  padding: 8px 12px;\n  border: 1px solid #ccc;\n  border-radius: 4px;\n  font-size: 14px;\n  resize: none;\n  height: 32px !important; /* Set fixed initial height */\n  min-height: 32px !important;\n  max-height: 96px;\n  overflow-y: auto;\n  line-height: 1.5;\n  width: 100%;\n  margin: 0;\n}\n\n.input-field:focus {\n  height: 32px !important; /* Maintain height on focus */\n  min-height: 32px !important;\n}\n\n.submit-button {\n  flex-shrink: 0;\n  padding: 0.5rem 2rem;\n  border-radius: 0.25rem;\n  border: none;\n  font-weight: 600;\n  background-color: white;\n  height: fit-content;\n  align-self: center;\n}\n\n.chat-input {\n  display: flex;\n  gap: 8px;\n  padding: 10px;\n  align-items: center;\n}\n\n.chat-container {\n  height: 400px;\n  overflow: auto;\n  margin: 10px;\n  display: flex;\n  flex-direction: column-reverse;\n}\n\n.chat-container::-webkit-scrollbar {\n  display: none;\n}\n\n.chat-header{\n  background-color: #0284c7;\n  padding: 10px 20px;\n  color: #fff;\n  font-weight: bold;\n  margin-bottom: 20px;\n}\n\n.theme-toggle-button {\n  border: none;\n  background: none;\n  padding: 0;\n  cursor: pointer;\n}\n\n.icon-wrapper {\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  border-radius: 50%;\n  padding: 5px;\n  background-color: #f0f0f0;\n}\n\n.icon-wrapper.dark-mode {\n  background-color: #000; /* Dark mode color */\n  color: white;\n}\n",""]);const s=i},314:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",o=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),o&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),o&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,o,r,a){"string"==typeof e&&(e=[[null,e,void 0]]);var i={};if(o)for(var s=0;s<this.length;s++){var c=this[s][0];null!=c&&(i[c]=!0)}for(var l=0;l<e.length;l++){var u=[].concat(e[l]);o&&i[u[0]]||(void 0!==a&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=a),n&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=n):u[2]=n),r&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=r):u[4]="".concat(r)),t.push(u))}},t}},601:e=>{e.exports=function(e){return e[1]}},338:(e,t,n)=>{var o=n(845);t.createRoot=o.createRoot,t.hydrateRoot=o.hydrateRoot},20:(e,t,n)=>{var o=n(883),r=Symbol.for("react.element"),a=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,s=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function l(e,t,n){var o,a={},l=null,u=null;for(o in void 0!==n&&(l=""+n),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(u=t.ref),t)i.call(t,o)&&!c.hasOwnProperty(o)&&(a[o]=t[o]);if(e&&e.defaultProps)for(o in t=e.defaultProps)void 0===a[o]&&(a[o]=t[o]);return{$$typeof:r,type:e,key:l,ref:u,props:a,_owner:s.current}}t.Fragment=a,t.jsx=l,t.jsxs=l},848:(e,t,n)=>{e.exports=n(20)},72:e=>{var t=[];function n(e){for(var n=-1,o=0;o<t.length;o++)if(t[o].identifier===e){n=o;break}return n}function o(e,o){for(var a={},i=[],s=0;s<e.length;s++){var c=e[s],l=o.base?c[0]+o.base:c[0],u=a[l]||0,d="".concat(l," ").concat(u);a[l]=u+1;var f=n(d),p={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==f)t[f].references++,t[f].updater(p);else{var h=r(p,o);o.byIndex=s,t.splice(s,0,{identifier:d,updater:h,references:1})}i.push(d)}return i}function r(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,r){var a=o(e=e||[],r=r||{});return function(e){e=e||[];for(var i=0;i<a.length;i++){var s=n(a[i]);t[s].references--}for(var c=o(e,r),l=0;l<a.length;l++){var u=n(a[l]);0===t[u].references&&(t[u].updater(),t.splice(u,1))}a=c}}},659:e=>{var t={};e.exports=function(e,n){var o=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(n)}},540:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},56:(e,t,n)=>{e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},825:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var o="";n.supports&&(o+="@supports (".concat(n.supports,") {")),n.media&&(o+="@media ".concat(n.media," {"));var r=void 0!==n.layer;r&&(o+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),o+=n.css,r&&(o+="}"),n.media&&(o+="}"),n.supports&&(o+="}");var a=n.sourceMap;a&&"undefined"!=typeof btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),t.styleTagTransform(o,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},113:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},63:(e,t,n)=>{var o=n(883),r="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},a=o.useState,i=o.useEffect,s=o.useLayoutEffect,c=o.useDebugValue;function l(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!r(e,n)}catch(e){return!0}}var u="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var n=t(),o=a({inst:{value:n,getSnapshot:t}}),r=o[0].inst,u=o[1];return s((function(){r.value=n,r.getSnapshot=t,l(r)&&u({inst:r})}),[e,n,t]),i((function(){return l(r)&&u({inst:r}),e((function(){l(r)&&u({inst:r})}))}),[e]),c(n),n};t.useSyncExternalStore=void 0!==o.useSyncExternalStore?o.useSyncExternalStore:u},888:(e,t,n)=>{e.exports=n(63)},883:t=>{t.exports=e},845:e=>{e.exports=t}},o={};function r(e){var t=o[e];if(void 0!==t)return t.exports;var a=o[e]={id:e,exports:{}};return n[e](a,a.exports,r),a.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.nc=void 0;var a={};return(()=>{r.r(a),r.d(a,{mountApp:()=>Ge});var e=r(848),t=r(883),n=r.n(t),o=r(338),i=r(72),s=r.n(i),c=r(825),l=r.n(c),u=r(659),d=r.n(u),f=r(56),p=r.n(f),h=r(540),g=r.n(h),m=r(113),v=r.n(m),y=r(626),b={};b.styleTagTransform=v(),b.setAttributes=p(),b.insert=d().bind(null,"head"),b.domAPI=l(),b.insertStyleElement=g(),s()(y.A,b),y.A&&y.A.locals&&y.A.locals;var w=r(888);const x=()=>{},_=x(),j=Object,O=e=>e===_,k=e=>"function"==typeof e,S=(e,t)=>({...e,...t}),E=new WeakMap;let C=0;const I=e=>{const t=typeof e,n=e&&e.constructor,o=n==Date;let r,a;if(j(e)!==e||o||n==RegExp)r=o?e.toJSON():"symbol"==t?e.toString():"string"==t?JSON.stringify(e):""+e;else{if(r=E.get(e),r)return r;if(r=++C+"~",E.set(e,r),n==Array){for(r="@",a=0;a<e.length;a++)r+=I(e[a])+",";E.set(e,r)}if(n==j){r="#";const t=j.keys(e).sort();for(;!O(a=t.pop());)O(e[a])||(r+=a+":"+I(e[a])+",");E.set(e,r)}}return r},R=new WeakMap,A={},T={},M="undefined",D=typeof window!=M,P=typeof document!=M,L=(e,t)=>{const n=R.get(e);return[()=>!O(t)&&e.get(t)||A,o=>{if(!O(t)){const r=e.get(t);t in T||(T[t]=r),n[5](t,S(r,o),r||A)}},n[6],()=>!O(t)&&t in T?T[t]:!O(t)&&e.get(t)||A]};let N=!0;const[F,z]=D&&window.addEventListener?[window.addEventListener.bind(window),window.removeEventListener.bind(window)]:[x,x],q={isOnline:()=>N,isVisible:()=>{const e=P&&document.visibilityState;return O(e)||"hidden"!==e}},V={initFocus:e=>(P&&document.addEventListener("visibilitychange",e),F("focus",e),()=>{P&&document.removeEventListener("visibilitychange",e),z("focus",e)}),initReconnect:e=>{const t=()=>{N=!0,e()},n=()=>{N=!1};return F("online",t),F("offline",n),()=>{z("online",t),z("offline",n)}}},W=!t.useId,H=!D||"Deno"in window,B=H?t.useEffect:t.useLayoutEffect,J="undefined"!=typeof navigator&&navigator.connection,U=!H&&J&&(["slow-2g","2g"].includes(J.effectiveType)||J.saveData),$=e=>{if(k(e))try{e=e()}catch(t){e=""}const t=e;return[e="string"==typeof e?e:(Array.isArray(e)?e.length:e)?I(e):"",t]};let K=0;const G=()=>++K;async function X(...e){const[t,n,o,r]=e,a=S({populateCache:!0,throwOnError:!0},"boolean"==typeof r?{revalidate:r}:r||{});let i=a.populateCache;const s=a.rollbackOnError;let c=a.optimisticData;const l=!1!==a.revalidate,u=a.throwOnError;if(k(n)){const e=n,o=[],r=t.keys();for(const n of r)!/^\$(inf|sub)\$/.test(n)&&e(t.get(n)._k)&&o.push(n);return Promise.all(o.map(d))}return d(n);async function d(n){const[r]=$(n);if(!r)return;const[a,d]=L(t,r),[f,p,h,g]=R.get(t),m=f[r],v=()=>l&&(delete h[r],delete g[r],m&&m[0])?m[0](2).then((()=>a().data)):a().data;if(e.length<3)return v();let y,b=o;const w=G();p[r]=[w,0];const x=!O(c),j=a(),S=j.data,E=j._c,C=O(E)?S:E;if(x&&(c=k(c)?c(C,S):c,d({data:c,_c:C})),k(b))try{b=b(C)}catch(e){y=e}if(b&&k(b.then)){if(b=await b.catch((e=>{y=e})),w!==p[r][0]){if(y)throw y;return b}y&&x&&(e=>"function"==typeof s?s(e):!1!==s)(y)&&(i=!0,b=C,d({data:b,_c:_}))}i&&(y||(k(i)&&(b=i(b,C)),d({data:b,error:_,_c:_}))),p[r][1]=G();const I=await v();if(d({_c:_}),!y)return i?I:b;if(u)throw y}}const Y=(e,t)=>{for(const n in e)e[n][0]&&e[n][0](t)},Q=(e,t)=>{if(!R.has(e)){const n=S(V,t),o={},r=X.bind(_,e);let a=x;const i={},s=(e,t)=>{const n=i[e]||[];return i[e]=n,n.push(t),()=>n.splice(n.indexOf(t),1)},c=(t,n,o)=>{e.set(t,n);const r=i[t];if(r)for(const e of r)e(n,o)},l=()=>{if(!R.has(e)&&(R.set(e,[o,{},{},{},r,c,s]),!H)){const t=n.initFocus(setTimeout.bind(_,Y.bind(_,o,0))),r=n.initReconnect(setTimeout.bind(_,Y.bind(_,o,1)));a=()=>{t&&t(),r&&r(),R.delete(e)}}};return l(),[e,r,l,a]}return[e,R.get(e)[4]]},[Z,ee]=Q(new Map),te=S({onLoadingSlow:x,onSuccess:x,onError:x,onErrorRetry:(e,t,n,o,r)=>{const a=n.errorRetryCount,i=r.retryCount,s=~~((Math.random()+.5)*(1<<(i<8?i:8)))*n.errorRetryInterval;!O(a)&&i>a||setTimeout(o,s,r)},onDiscarded:x,revalidateOnFocus:!0,revalidateOnReconnect:!0,revalidateIfStale:!0,shouldRetryOnError:!0,errorRetryInterval:U?1e4:5e3,focusThrottleInterval:5e3,dedupingInterval:2e3,loadingTimeout:U?5e3:3e3,compare:(e,t)=>I(e)==I(t),isPaused:()=>!1,cache:Z,mutate:ee,fallback:{}},q),ne=(e,t)=>{const n=S(e,t);if(t){const{use:o,fallback:r}=e,{use:a,fallback:i}=t;o&&a&&(n.use=o.concat(a)),r&&i&&(n.fallback=S(r,i))}return n},oe=(0,t.createContext)({}),re=D&&window.__SWR_DEVTOOLS_USE__,ae=re?window.__SWR_DEVTOOLS_USE__:[],ie=ae.concat((e=>(t,n,o)=>e(t,n&&((...e)=>{const[o]=$(t),[,,,r]=R.get(Z),a=r[o];return O(a)?n(...e):(delete r[o],a)}),o)));re&&(window.__SWR_DEVTOOLS_REACT__=t);const se=t.use||(e=>{if("pending"===e.status)throw e;if("fulfilled"===e.status)return e.value;throw"rejected"===e.status?e.reason:(e.status="pending",e.then((t=>{e.status="fulfilled",e.value=t}),(t=>{e.status="rejected",e.reason=t})),e)}),ce={dedupe:!0},le=(j.defineProperty((e=>{const{value:n}=e,o=(0,t.useContext)(oe),r=k(n),a=(0,t.useMemo)((()=>r?n(o):n),[r,o,n]),i=(0,t.useMemo)((()=>r?a:ne(o,a)),[r,o,a]),s=a&&a.provider,c=(0,t.useRef)(_);s&&!c.current&&(c.current=Q(s(i.cache||Z),a));const l=c.current;return l&&(i.cache=l[0],i.mutate=l[1]),B((()=>{if(l)return l[2]&&l[2](),l[3]}),[]),(0,t.createElement)(oe.Provider,S(e,{value:i}))}),"defaultValue",{value:te}),ue=(e,n,o)=>{const{cache:r,compare:a,suspense:i,fallbackData:s,revalidateOnMount:c,revalidateIfStale:l,refreshInterval:u,refreshWhenHidden:d,refreshWhenOffline:f,keepPreviousData:p}=o,[h,g,m,v]=R.get(r),[y,b]=$(e),x=(0,t.useRef)(!1),j=(0,t.useRef)(!1),E=(0,t.useRef)(y),C=(0,t.useRef)(n),I=(0,t.useRef)(o),A=()=>I.current,T=()=>A().isVisible()&&A().isOnline(),[P,N,F,z]=L(r,y),q=(0,t.useRef)({}).current,V=O(s)?o.fallback[y]:s,J=(e,t)=>{for(const n in q){const o=n;if("data"===o){if(!a(e[o],t[o])){if(!O(e[o]))return!1;if(!a(oe,t[o]))return!1}}else if(t[o]!==e[o])return!1}return!0},U=(0,t.useMemo)((()=>{const e=!!y&&!!n&&(O(c)?!A().isPaused()&&!i&&(!!O(l)||l):c),t=t=>{const n=S(t);return delete n._k,e?{isValidating:!0,isLoading:!0,...n}:n},o=P(),r=z(),a=t(o),s=o===r?a:t(r);let u=a;return[()=>{const e=t(P());return J(e,u)?(u.data=e.data,u.isLoading=e.isLoading,u.isValidating=e.isValidating,u.error=e.error,u):(u=e,e)},()=>s]}),[r,y]),K=(0,w.useSyncExternalStore)((0,t.useCallback)((e=>F(y,((t,n)=>{J(n,t)||e()}))),[r,y]),U[0],U[1]),Y=!x.current,Q=h[y]&&h[y].length>0,Z=K.data,ee=O(Z)?V:Z,te=K.error,ne=(0,t.useRef)(ee),oe=p?O(Z)?ne.current:Z:ee,re=!(Q&&!O(te))&&(Y&&!O(c)?c:!A().isPaused()&&(i?!O(ee)&&l:O(ee)||l)),ae=!!(y&&n&&Y&&re),ie=O(K.isValidating)?ae:K.isValidating,le=O(K.isLoading)?ae:K.isLoading,ue=(0,t.useCallback)((async e=>{const t=C.current;if(!y||!t||j.current||A().isPaused())return!1;let n,r,i=!0;const s=e||{},c=!m[y]||!s.dedupe,l=()=>W?!j.current&&y===E.current&&x.current:y===E.current,u={isValidating:!1,isLoading:!1},d=()=>{N(u)},f=()=>{const e=m[y];e&&e[1]===r&&delete m[y]},p={isValidating:!0};O(P().data)&&(p.isLoading=!0);try{if(c&&(N(p),o.loadingTimeout&&O(P().data)&&setTimeout((()=>{i&&l()&&A().onLoadingSlow(y,o)}),o.loadingTimeout),m[y]=[t(b),G()]),[n,r]=m[y],n=await n,c&&setTimeout(f,o.dedupingInterval),!m[y]||m[y][1]!==r)return c&&l()&&A().onDiscarded(y),!1;u.error=_;const e=g[y];if(!O(e)&&(r<=e[0]||r<=e[1]||0===e[1]))return d(),c&&l()&&A().onDiscarded(y),!1;const s=P().data;u.data=a(s,n)?s:n,c&&l()&&A().onSuccess(n,y,o)}catch(e){f();const t=A(),{shouldRetryOnError:n}=t;t.isPaused()||(u.error=e,c&&l()&&(t.onError(e,y,t),(!0===n||k(n)&&n(e))&&T()&&t.onErrorRetry(e,y,t,(e=>{const t=h[y];t&&t[0]&&t[0](3,e)}),{retryCount:(s.retryCount||0)+1,dedupe:!0})))}return i=!1,d(),!0}),[y,r]),de=(0,t.useCallback)(((...e)=>X(r,E.current,...e)),[]);if(B((()=>{C.current=n,I.current=o,O(Z)||(ne.current=Z)})),B((()=>{if(!y)return;const e=ue.bind(_,ce);let t=0;const n=((e,t,n)=>{const o=t[e]||(t[e]=[]);return o.push(n),()=>{const e=o.indexOf(n);e>=0&&(o[e]=o[o.length-1],o.pop())}})(y,h,((n,o={})=>{if(0==n){const n=Date.now();A().revalidateOnFocus&&n>t&&T()&&(t=n+A().focusThrottleInterval,e())}else if(1==n)A().revalidateOnReconnect&&T()&&e();else{if(2==n)return ue();if(3==n)return ue(o)}}));return j.current=!1,E.current=y,x.current=!0,N({_k:b}),re&&(O(ee)||H?e():(o=e,D&&typeof window.requestAnimationFrame!=M?window.requestAnimationFrame(o):setTimeout(o,1))),()=>{j.current=!0,n()};var o}),[y]),B((()=>{let e;function t(){const t=k(u)?u(P().data):u;t&&-1!==e&&(e=setTimeout(n,t))}function n(){P().error||!d&&!A().isVisible()||!f&&!A().isOnline()?t():ue(ce).then(t)}return t(),()=>{e&&(clearTimeout(e),e=-1)}}),[u,d,f,y]),(0,t.useDebugValue)(oe),i&&O(ee)&&y){if(!W&&H)throw new Error("Fallback data is required when using suspense in SSR.");C.current=n,I.current=o,j.current=!1;const e=v[y];if(!O(e)){const t=de(e);se(t)}if(!O(te))throw te;{const e=ue(ce);O(oe)||(e.status="fulfilled",e.value=!0),se(e)}}return{mutate:de,get data(){return q.data=!0,oe},get error(){return q.error=!0,te},get isValidating(){return q.isValidating=!0,ie},get isLoading(){return q.isLoading=!0,le}}},function(...e){const n=S(te,(0,t.useContext)(oe)),[o,r,a]=(e=>k(e[1])?[e[0],e[1],e[2]||{}]:[e[0],null,(null===e[1]?e[2]:e[1])||{}])(e),i=ne(n,a);let s=ue;const{use:c}=i,l=(c||[]).concat(ie);for(let e=l.length;e--;)s=l[e](s);return s(o,r||i.fetcher||null,i)});var ue,de={code:"0",name:"text",parse:e=>{if("string"!=typeof e)throw new Error('"text" parts expect a string value.');return{type:"text",value:e}}},fe={code:"1",name:"function_call",parse:e=>{if(null==e||"object"!=typeof e||!("function_call"in e)||"object"!=typeof e.function_call||null==e.function_call||!("name"in e.function_call)||!("arguments"in e.function_call)||"string"!=typeof e.function_call.name||"string"!=typeof e.function_call.arguments)throw new Error('"function_call" parts expect an object with a "function_call" property.');return{type:"function_call",value:e}}},pe={code:"2",name:"data",parse:e=>{if(!Array.isArray(e))throw new Error('"data" parts expect an array value.');return{type:"data",value:e}}},he={code:"3",name:"error",parse:e=>{if("string"!=typeof e)throw new Error('"error" parts expect a string value.');return{type:"error",value:e}}},ge={code:"4",name:"assistant_message",parse:e=>{if(!(null!=e&&"object"==typeof e&&"id"in e&&"role"in e&&"content"in e&&"string"==typeof e.id&&"string"==typeof e.role&&"assistant"===e.role&&Array.isArray(e.content)&&e.content.every((e=>null!=e&&"object"==typeof e&&"type"in e&&"text"===e.type&&"text"in e&&null!=e.text&&"object"==typeof e.text&&"value"in e.text&&"string"==typeof e.text.value))))throw new Error('"assistant_message" parts expect an object with an "id", "role", and "content" property.');return{type:"assistant_message",value:e}}},me={code:"5",name:"assistant_control_data",parse:e=>{if(null==e||"object"!=typeof e||!("threadId"in e)||!("messageId"in e)||"string"!=typeof e.threadId||"string"!=typeof e.messageId)throw new Error('"assistant_control_data" parts expect an object with a "threadId" and "messageId" property.');return{type:"assistant_control_data",value:{threadId:e.threadId,messageId:e.messageId}}}},ve={code:"6",name:"data_message",parse:e=>{if(null==e||"object"!=typeof e||!("role"in e)||!("data"in e)||"string"!=typeof e.role||"data"!==e.role)throw new Error('"data_message" parts expect an object with a "role" and "data" property.');return{type:"data_message",value:e}}},ye={code:"7",name:"tool_calls",parse:e=>{if(null==e||"object"!=typeof e||!("tool_calls"in e)||"object"!=typeof e.tool_calls||null==e.tool_calls||!Array.isArray(e.tool_calls)||e.tool_calls.some((e=>{null!=e&&"object"==typeof e&&"id"in e&&"string"==typeof e.id&&"type"in e&&"string"==typeof e.type&&"function"in e&&null!=e.function&&"object"==typeof e.function&&"arguments"in e.function&&"string"==typeof e.function.name&&e.function.arguments})))throw new Error('"tool_calls" parts expect an object with a ToolCallPayload.');return{type:"tool_calls",value:e}}},be={code:"8",name:"message_annotations",parse:e=>{if(!Array.isArray(e))throw new Error('"message_annotations" parts expect an array value.');return{type:"message_annotations",value:e}}},we={[de.code]:de,[fe.code]:fe,[pe.code]:pe,[he.code]:he,[ge.code]:ge,[me.code]:me,[ve.code]:ve,[ye.code]:ye,[be.code]:be},xe=[de,fe,pe,he,ge,me,ve,ye,be].map((e=>e.code)),_e=e=>{const t=e.indexOf(":");if(-1===t)throw new Error("Failed to parse stream string. No separator found.");const n=e.slice(0,t);if(!xe.includes(n))throw new Error(`Failed to parse stream string. Invalid code ${n}.`);const o=n,r=e.slice(t+1),a=JSON.parse(r);return we[o].parse(a)},je="\n".charCodeAt(0);function Oe(e,t){const n=new Uint8Array(t);let o=0;for(const t of e)n.set(t,o),o+=t.length;return e.length=0,n}var ke=((e,t=21)=>(n=t)=>{let o="",r=n;for(;r--;)o+=e[Math.random()*e.length|0];return o})("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",7);function Se(e,t){return e&&t&&t.length?{...e,annotations:[...t]}:e}async function Ee({api:e,messages:t,body:n,credentials:o,headers:r,abortController:a,appendMessage:i,restoreMessagesOnFailure:s,onResponse:c,onUpdate:l,onFinish:u,generateId:d}){var f;const p=await fetch(e,{method:"POST",body:JSON.stringify({messages:t,...n}),headers:{"Content-Type":"application/json",...r},signal:null==(f=null==a?void 0:a())?void 0:f.signal,credentials:o}).catch((e=>{throw s(),e}));if(c)try{await c(p)}catch(e){throw e}if(!p.ok)throw s(),new Error(await p.text()||"Failed to fetch the chat response.");if(!p.body)throw new Error("The response body is empty.");const h=p.body.getReader();if("true"===p.headers.get("X-Experimental-Stream-Data"))return await async function({reader:e,abortControllerRef:t,update:n,onFinish:o,generateId:r=ke,getCurrentDate:a=(()=>new Date)}){const i=a(),s={data:[]};let c;for await(const{type:o,value:a}of async function*(e,{isAborted:t}={}){const n=new TextDecoder,o=[];let r=0;for(;;){const{value:a}=await e.read();if(a&&(o.push(a),r+=a.length,a[a.length-1]!==je))continue;if(0===o.length)break;const i=Oe(o,r);r=0;const s=n.decode(i,{stream:!0}).split("\n").filter((e=>""!==e)).map(_e);for(const e of s)yield e;if(null==t?void 0:t()){e.cancel();break}}}(e,{isAborted:()=>null===(null==t?void 0:t.current)})){"text"===o&&(s.text?s.text={...s.text,content:(s.text.content||"")+a}:s.text={id:r(),role:"assistant",content:a,createdAt:i});let e=null;"function_call"===o&&(s.function_call={id:r(),role:"assistant",content:"",function_call:a.function_call,name:a.function_call.name,createdAt:i},e=s.function_call);let t=null;"tool_calls"===o&&(s.tool_calls={id:r(),role:"assistant",content:"",tool_calls:a.tool_calls,createdAt:i},t=s.tool_calls),"data"===o&&s.data.push(...a);let l=s.text;"message_annotations"===o&&(c?c.push(...a):c=[...a],e=Se(s.function_call,c),t=Se(s.tool_calls,c),l=Se(s.text,c)),(null==c?void 0:c.length)&&["text","function_call","tool_calls"].forEach((e=>{s[e]&&(s[e].annotations=[...c])})),n([e,t,l].filter(Boolean).map((e=>({...Se(e,c)}))),[...s.data])}return null==o||o(s),{messages:[s.text,s.function_call,s.tool_calls].filter(Boolean),data:s.data}}({reader:h,abortControllerRef:null!=a?{current:a()}:void 0,update:l,onFinish(e){u&&null!=e.text&&u(e.text)},generateId:d});{const e=new Date,t=function(e){const t=new TextDecoder;return e?function(e){return t.decode(e,{stream:!0}).split("\n").filter((e=>""!==e)).map(_e).filter(Boolean)}:function(e){return e?t.decode(e,{stream:!0}):""}}(!1);let n="",o={id:d(),createdAt:e,content:"",role:"assistant"};for(;;){const{done:e,value:r}=await h.read();if(e)break;if(n+=t(r),n.startsWith('{"function_call":')?o.function_call=n:n.startsWith('{"tool_calls":')?o.tool_calls=n:o.content=n,i({...o}),null===(null==a?void 0:a())){h.cancel();break}}if(n.startsWith('{"function_call":')){const e=JSON.parse(n).function_call;o.function_call=e,i({...o})}if(n.startsWith('{"tool_calls":')){const e=JSON.parse(n).tool_calls;o.tool_calls=e,i({...o})}return u&&u(o),o}}var Ce=async(e,t,n,o,r,a,i,s,c,l,u,d)=>{var f,p;const h=i.current;n(t.messages,!1);const g=d?t.messages:t.messages.map((({role:e,content:t,name:n,function_call:o,tool_calls:r,tool_call_id:a})=>({role:e,content:t,tool_call_id:a,...void 0!==n&&{name:n},...void 0!==o&&{function_call:o},...void 0!==r&&{tool_calls:r}})));if("string"!=typeof e){let m={id:c(),createdAt:new Date,content:"",role:"assistant"};async function v(e){const{content:o,ui:r,next:a}=await e;m.content=o,m.ui=await r,n([...t.messages,{...m}],!1),a&&await v(a)}try{const y=e({messages:g,data:t.data});await v(y)}catch(b){throw n(h,!1),b}return l&&l(m),m}return await Ee({api:e,messages:g,body:{data:t.data,...a.current.body,...null==(f=t.options)?void 0:f.body,...void 0!==t.functions&&{functions:t.functions},...void 0!==t.function_call&&{function_call:t.function_call},...void 0!==t.tools&&{tools:t.tools},...void 0!==t.tool_choice&&{tool_choice:t.tool_choice}},credentials:a.current.credentials,headers:{...a.current.headers,...null==(p=t.options)?void 0:p.headers},abortController:()=>s.current,appendMessage(e){n([...t.messages,e],!1)},restoreMessagesOnFailure(){n(h,!1)},onResponse:u,onUpdate(e,a){n([...t.messages,...e],!1),o([...r||[],...a||[]],!1)},onFinish:l,generateId:c})};var Ie={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},Re=t.createContext&&t.createContext(Ie),Ae=["attr","size","title"];function Te(){return Te=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},Te.apply(this,arguments)}function Me(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function De(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Me(Object(n),!0).forEach((function(t){var o,r,a,i;o=e,r=t,a=n[t],(r="symbol"==typeof(i=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,"string");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r))?i:i+"")in o?Object.defineProperty(o,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):o[r]=a})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Me(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Pe(e){return e&&e.map(((e,n)=>t.createElement(e.tag,De({key:n},e.attr),Pe(e.child))))}function Le(e){return n=>t.createElement(Ne,Te({attr:De({},e.attr)},n),Pe(e.child))}function Ne(e){var n=n=>{var o,{attr:r,size:a,title:i}=e,s=function(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;n[o]=e[o]}return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}(e,Ae),c=a||n.size||"1em";return n.className&&(o=n.className),e.className&&(o=(o?o+" ":"")+e.className),t.createElement("svg",Te({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,r,s,{className:o,style:De(De({color:e.color||n.color},n.style),e.style),height:c,width:c,xmlns:"http://www.w3.org/2000/svg"}),i&&t.createElement("title",null,i),e.children)};return void 0!==Re?t.createElement(Re.Consumer,null,(e=>n(e))):n(Ie)}function Fe(e){return Le({tag:"svg",attr:{t:"1569682613478",viewBox:"0 0 1024 1024",version:"1.1"},child:[{tag:"path",attr:{d:"M852 64H172c-17.7 0-32 14.3-32 32v660c0 17.7 14.3 32 32 32h680c17.7 0 32-14.3 32-32V96c0-17.7-14.3-32-32-32zM300 328c0-33.1 26.9-60 60-60s60 26.9 60 60-26.9 60-60 60-60-26.9-60-60z m372 248c0 4.4-3.6 8-8 8H360c-4.4 0-8-3.6-8-8v-60c0-4.4 3.6-8 8-8h304c4.4 0 8 3.6 8 8v60z m-8-188c-33.1 0-60-26.9-60-60s26.9-60 60-60 60 26.9 60 60-26.9 60-60 60zM799 864H225c-13.8 0-25 14.3-25 32v56c0 4.4 2.8 8 6.2 8h611.5c3.4 0 6.2-3.6 6.2-8v-56c0.1-17.7-11.1-32-24.9-32z"},child:[]}]})(e)}function ze(e){return Le({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M332.64 64.58C313.18 43.57 286 32 256 32c-30.16 0-57.43 11.5-76.8 32.38-19.58 21.11-29.12 49.8-26.88 80.78C156.76 206.28 203.27 256 256 256s99.16-49.71 103.67-110.82c2.27-30.7-7.33-59.33-27.03-80.6zM432 480H80a31 31 0 0 1-24.2-11.13c-6.5-7.77-9.12-18.38-7.18-29.11C57.06 392.94 83.4 353.61 124.8 326c36.78-24.51 83.37-38 131.2-38s94.42 13.5 131.2 38c41.4 27.6 67.74 66.93 76.18 113.75 1.94 10.73-.68 21.34-7.18 29.11A31 31 0 0 1 432 480z"},child:[]}]})(e)}function qe(t){var n,o,r="user"===t.message.role,a="message-bubble ".concat(r?"message-bubble-user":"message-bubble-ai"),i=r?null!==(n=t.humanIcon)&&void 0!==n?n:(0,e.jsx)(ze,{}):null!==(o=t.aiIcon)&&void 0!==o?o:(0,e.jsx)(Fe,{});return(0,e.jsxs)("div",{className:a,children:[(0,e.jsx)("div",{className:"message-prefix",children:i}),(0,e.jsx)("div",{className:"message-content",children:(0,e.jsx)("span",{children:t.message.content})})]})}function Ve(e){return Le({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M320 0c17.7 0 32 14.3 32 32l0 64 120 0c39.8 0 72 32.2 72 72l0 272c0 39.8-32.2 72-72 72l-304 0c-39.8 0-72-32.2-72-72l0-272c0-39.8 32.2-72 72-72l120 0 0-64c0-17.7 14.3-32 32-32zM208 384c-8.8 0-16 7.2-16 16s7.2 16 16 16l32 0c8.8 0 16-7.2 16-16s-7.2-16-16-16l-32 0zm96 0c-8.8 0-16 7.2-16 16s7.2 16 16 16l32 0c8.8 0 16-7.2 16-16s-7.2-16-16-16l-32 0zm96 0c-8.8 0-16 7.2-16 16s7.2 16 16 16l32 0c8.8 0 16-7.2 16-16s-7.2-16-16-16l-32 0zM264 256a40 40 0 1 0 -80 0 40 40 0 1 0 80 0zm152 40a40 40 0 1 0 0-80 40 40 0 1 0 0 80zM48 224l16 0 0 192-16 0c-26.5 0-48-21.5-48-48l0-96c0-26.5 21.5-48 48-48zm544 0c26.5 0 48 21.5 48 48l0 96c0 26.5-21.5 48-48 48l-16 0 0-192 16 0z"},child:[]}]})(e)}function We(e){return Le({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 3a9 9 0 1 0 9 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 0 1-4.4 2.26 5.403 5.403 0 0 1-3.14-9.8c-.44-.06-.9-.1-1.36-.1z"},child:[]}]})(e)}function He(e){return Le({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58a.996.996 0 0 0-1.41 0 .996.996 0 0 0 0 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37a.996.996 0 0 0-1.41 0 .996.996 0 0 0 0 1.41l1.06 1.06c.39.39 1.03.39 1.41 0a.996.996 0 0 0 0-1.41l-1.06-1.06zm1.06-10.96a.996.996 0 0 0 0-1.41.996.996 0 0 0-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36a.996.996 0 0 0 0-1.41.996.996 0 0 0-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z"},child:[]}]})(e)}var Be=function(){return Be=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},Be.apply(this,arguments)},Je=function(e,t,n){if(n||2===arguments.length)for(var o,r=0,a=t.length;r<a;r++)!o&&r in t||(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))};function Ue(n){var o=(0,t.useRef)(null),r=(0,t.useState)(!1),a=r[0],i=r[1],s=(0,t.useState)("light"),c=s[0],l=s[1];(0,t.useEffect)((function(){var e=window.matchMedia("(prefers-color-scheme: dark)"),t=function(e){return l(e.matches?"dark":"light")};return e.addEventListener("change",t),l(e.matches?"dark":"light"),function(){return e.removeEventListener("change",t)}}),[]);var u=window.innerWidth<=768,d={flex:1,flexDirection:"column",overflow:"hidden",backgroundColor:"dark"===c?"#333333":"white",color:"dark"===c?"#fff":"#000",position:"fixed",bottom:u?"160px":"100px",right:u?"60px":"40px",borderRadius:"10px",width:u?"90%":"400px"},f=n.endpoint,p=n.placeholder,h=n.aiIcon,g=n.humanIcon,m=n.chatIcon,v=n.titleText,y=n.initialMessage,b=(0,t.useState)({}),w=b[0],x=b[1],_=function({api:e="/api/chat",id:n,initialMessages:o,initialInput:r="",sendExtraMessageFields:a,experimental_onFunctionCall:i,experimental_onToolCall:s,onResponse:c,onFinish:l,onError:u,credentials:d,headers:f,body:p,generateId:h=ke}={}){const g=(0,t.useId)(),m=null!=n?n:g,v="string"==typeof e?[e,m]:m,[y]=(0,t.useState)([]),{data:b,mutate:w}=le([v,"messages"],null,{fallbackData:null!=o?o:y}),{data:x=!1,mutate:_}=le([v,"loading"],null),{data:j,mutate:O}=le([v,"streamData"],null),{data:k,mutate:S}=le([v,"error"],null),E=(0,t.useRef)(b||[]);(0,t.useEffect)((()=>{E.current=b||[]}),[b]);const C=(0,t.useRef)(null),I=(0,t.useRef)({credentials:d,headers:f,body:p});(0,t.useEffect)((()=>{I.current={credentials:d,headers:f,body:p}}),[d,f,p]);const R=(0,t.useCallback)((async t=>{try{_(!0),S(void 0);const n=new AbortController;C.current=n,await async function({getStreamedResponse:e,experimental_onFunctionCall:t,experimental_onToolCall:n,updateChatRequest:o,getCurrentMessages:r}){for(;;){const a=await e();if("messages"in a){let e=!1;for(const i of a.messages)if(void 0!==i.function_call&&"string"!=typeof i.function_call||void 0!==i.tool_calls&&"string"!=typeof i.tool_calls){if(e=!0,t){const n=i.function_call;if("object"!=typeof n){console.warn("experimental_onFunctionCall should not be defined when using tools");continue}const a=await t(r(),n);if(void 0===a){e=!1;break}o(a)}if(n){const t=i.tool_calls;if(!Array.isArray(t)||t.some((e=>"object"!=typeof e))){console.warn("experimental_onToolCall should not be defined when using tools");continue}const a=await n(r(),t);if(void 0===a){e=!1;break}o(a)}}if(!e)break}else{let e=function(e){for(const t of e.messages){if(void 0!==t.tool_calls)for(const e of t.tool_calls)"object"==typeof e&&e.function.arguments&&"string"!=typeof e.function.arguments&&(e.function.arguments=JSON.stringify(e.function.arguments));void 0!==t.function_call&&"object"==typeof t.function_call&&t.function_call.arguments&&"string"!=typeof t.function_call.arguments&&(t.function_call.arguments=JSON.stringify(t.function_call.arguments))}};const i=a;if(!(void 0!==i.function_call&&"string"!=typeof i.function_call||void 0!==i.tool_calls&&"string"!=typeof i.tool_calls))break;if(t){const n=i.function_call;if("object"!=typeof n){console.warn("experimental_onFunctionCall should not be defined when using tools");continue}const a=await t(r(),n);if(void 0===a)break;e(a),o(a)}if(n){const t=i.tool_calls;if("object"!=typeof t){console.warn("experimental_onToolCall should not be defined when using functions");continue}const a=await n(r(),t);if(void 0===a)break;e(a),o(a)}}}}({getStreamedResponse:()=>Ce(e,t,w,O,j,I,E,C,h,l,c,a),experimental_onFunctionCall:i,experimental_onToolCall:s,updateChatRequest:e=>{t=e},getCurrentMessages:()=>E.current}),C.current=null}catch(e){if("AbortError"===e.name)return C.current=null,null;u&&e instanceof Error&&u(e),S(e)}finally{_(!1)}}),[w,_,e,I,c,l,u,S,O,j,a,i,s,E,C,h]),A=(0,t.useCallback)((async(e,{options:t,functions:n,function_call:o,tools:r,tool_choice:a,data:i}={})=>{e.id||(e.id=h());const s={messages:E.current.concat(e),options:t,data:i,...void 0!==n&&{functions:n},...void 0!==o&&{function_call:o},...void 0!==r&&{tools:r},...void 0!==a&&{tool_choice:a}};return R(s)}),[R,h]),T=(0,t.useCallback)((async({options:e,functions:t,function_call:n,tools:o,tool_choice:r}={})=>{if(0===E.current.length)return null;if("assistant"===E.current[E.current.length-1].role){const a={messages:E.current.slice(0,-1),options:e,...void 0!==t&&{functions:t},...void 0!==n&&{function_call:n},...void 0!==o&&{tools:o},...void 0!==r&&{tool_choice:r}};return R(a)}const a={messages:E.current,options:e,...void 0!==t&&{functions:t},...void 0!==n&&{function_call:n},...void 0!==o&&{tools:o},...void 0!==r&&{tool_choice:r}};return R(a)}),[R]),M=(0,t.useCallback)((()=>{C.current&&(C.current.abort(),C.current=null)}),[]),D=(0,t.useCallback)((e=>{w(e,!1),E.current=e}),[w]),[P,L]=(0,t.useState)(r),N=(0,t.useCallback)(((e,t={},n)=>{n&&(I.current={...I.current,...n}),e.preventDefault(),P&&(A({content:P,role:"user",createdAt:new Date},t),L(""))}),[P,A]);return{messages:b||[],error:k,append:A,reload:T,stop:M,setMessages:D,input:P,setInput:L,handleInputChange:e=>{L(e.target.value)},handleSubmit:N,isLoading:x,data:j}}({api:f,onResponse:function(e){var t,n=e.headers.get("x-sources"),o=n?JSON.parse(Buffer.from(n,"base64").toString("utf8")):[],r=e.headers.get("x-message-index");o.length&&null!==r&&x(Be(Be({},w),((t={})[r]=o,t)))},onError:function(e){var t="I'm having trouble responding right now. Please try again in a moment.";e.message.includes("Failed to fetch")||e.message.includes("network")?t="Unable to connect. Please check your internet connection and try again.":e.message.includes("timeout")&&(t="The response took too long. Please try again."),j.push({id:"error-"+Date.now(),content:t,createdAt:new Date(Date.now()),role:"assistant"})}}),j=_.messages,O=_.input,k=_.handleInputChange,S=_.handleSubmit,E=_.isLoading;return(0,t.useEffect)((function(){j.length||j.push({id:"initial",content:y||"Hi, how may I help you?",createdAt:new Date(Date.now()),role:"assistant"})}),[]),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("button",{className:"chat-button",onClick:function(){return i(!a)},children:null!=m?m:(0,e.jsx)(Ve,{})}),(0,e.jsxs)("div",{style:d,children:[a&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:"chat-header",style:{display:"flex",justifyContent:"space-between"},children:[(0,e.jsx)("div",{children:v}),(0,e.jsx)("button",{onClick:function(){l((function(e){return"light"===e?"dark":"light"}))},className:"theme-toggle-button",children:(0,e.jsx)("div",{className:"dark"===c?"icon-wrapper":"icon-wrapper dark-mode",children:"dark"===c?(0,e.jsx)(He,{}):(0,e.jsx)(We,{})})})]}),(0,e.jsx)("div",{className:"chat-container",children:(0,e.jsx)("div",{ref:o,children:j.length>0?Je([],j,!0).map((function(t,n){return(0,e.jsx)(qe,{message:t,aiIcon:h,humanIcon:g},t.id)})):""})})]}),a&&(0,e.jsx)("form",{onSubmit:function(e){return t=this,n=void 0,a=function(){return function(e,t){var n,o,r,a,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(i=0)),i;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,o=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((r=(r=i.trys).length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){i.label=s[1];break}if(6===s[0]&&i.label<r[1]){i.label=r[1],r=s;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(s);break}r[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}(this,(function(t){switch(t.label){case 0:return e.preventDefault(),o.current&&o.current.classList.add("grow"),j.length?[3,2]:[4,new Promise((function(e){return setTimeout(e,300)}))];case 1:t.sent(),t.label=2;case 2:return null!=E&&E||S(e),[2]}}))},new((r=void 0)||(r=Promise))((function(e,o){function i(e){try{c(a.next(e))}catch(e){o(e)}}function s(e){try{c(a.throw(e))}catch(e){o(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof r?n:new r((function(e){e(n)}))).then(i,s)}c((a=a.apply(t,n||[])).next())}));var t,n,r,a},className:"form-container",children:(0,e.jsxs)("div",{className:"chat-input",children:[(0,e.jsx)("textarea",{className:"input-field",value:O,placeholder:null!=p?p:"Type your message here...",onChange:function(e){k(e);var t=parseInt(window.getComputedStyle(e.target).lineHeight),n=(e.target.value.split("\n").length,e.target.scrollHeight);if(n>t&&n>32){var o=Math.min(n,96);e.target.style.height="".concat(o,"px")}else e.target.style.height="32px"},onKeyDown:function(e){if("Enter"===e.key&&!e.shiftKey){e.preventDefault();var t=e.currentTarget.form;t&&t.requestSubmit()}},rows:1,style:{height:"32px"}}),(0,e.jsx)("button",{type:"submit",className:"submit-button",children:E?(0,e.jsx)("div",{role:"status",className:"flex justify-center",children:(0,e.jsx)("span",{children:"Loading..."})}):"Send"})]})})]})]})}const $e=function(t){var n=t.endpoint,o=t.aiIcon,r=t.titleText,a=t.placeholder,i=t.humanIcon,s=t.chatIcon;return(0,e.jsx)(Ue,{endpoint:n||"http://localhost:3500/api/v1/langchain-chat/context-aware-chat",aiIcon:o,humanIcon:i,chatIcon:s,placeholder:a||"Ask a question...",titleText:r||"Chatbot"})};var Ke=function(){return Ke=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},Ke.apply(this,arguments)};function Ge(t){var r=document.getElementById("root");if(r){var a=Ke(Ke({},window.chatConfig),t);o.createRoot(r).render((0,e.jsx)(n().StrictMode,{children:(0,e.jsx)($e,{endpoint:a.endpoint,aiIcon:a.aiIcon,titleText:a.titleText,placeholder:a.placeholder,humanIcon:a.humanIcon,chatIcon:a.chatIcon})}))}else console.error('No <div id="root"></div> in the HTML.')}})(),a})()));